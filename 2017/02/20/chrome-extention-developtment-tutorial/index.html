<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/Torpedo.css">
  <link rel="stylesheet" href="/css/yewmint.css">
  <title>主页 | Yewth</title>
</head>

  <body>
    <div id="wrapper">
      <header id="page-header">
  <div id="header-title">
    <a href="/">Yewth</a>
  </div>
  <div id="header-nav">
    <ul>
      
        <li><a target="_blank" class="menu-item " href="/">Index</a></li>
      
        <li><a target="_blank" class="menu-item " href="https://github.com/yewmint">GITHUB</a></li>
      
    </ul>
</header>

      <article class="article">
  <h1 id="-" class="article-title">Chrome Extention Developtment Tutorial</h1>
  <p class="article-date">2017-02-20</p>
  <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><strong>Chrome extension</strong> consist of several html/css/js files and <code>manifest.json</code>.</p>
<p>Treeview of a extension is usually like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- extension</div><div class="line">  - html</div><div class="line">    - ...</div><div class="line">  - css</div><div class="line">    - ...</div><div class="line">  - js</div><div class="line">    - ...</div><div class="line">  - manifest.json</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>In term of <em>funcion</em>, extension can be divided into 5 parts:</p>
<ol>
<li>manifest.json</li>
<li>popup</li>
<li>background</li>
<li>content-script</li>
<li>setting</li>
</ol>
<p>Firstly we create a project directory like above, and insert<br>some definitions into <code>manifest.json</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"My extension"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"0.1"</span>,</div><div class="line">  <span class="attr">"manifest_version"</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">"Learn how to code extension."</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Enter <code>chrome://extensions/</code> in chrome, click <code>Developer mode</code>,<br>click <code>Load unpacked extension</code>, choose root directory of our extension.</p>
<p>Yeah! We’ve got prototype of our extension.</p>
<h2 id="Popup"><a href="#Popup" class="headerlink" title="Popup"></a>Popup</h2><p>An extension usually add an icon on top-right tool bar of chrome,<br>which pop up a page when it’s clicked.</p>
<p>This is called <strong>Browser Action</strong>, the page is substantively a html file.<br>Let’s create a file <code>popup.html</code> in <code>html/</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    Here I poped!</div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Add browser action attribute into <code>manifest.json</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"browser_action"</span>: &#123;</div><div class="line">    <span class="attr">"default_title"</span>: <span class="string">"My extension"</span>,</div><div class="line">    <span class="attr">"default_icon"</span>: <span class="string">"img/icon.png"</span>,</div><div class="line">    <span class="attr">"default_popup"</span>: <span class="string">"html/popup.html"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Reload our extension in <code>chrome://extensions</code>, we can see our button on<br>top-right tool bar. <code>popup.html</code> will be poped when we click it.</p>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>An extension will have some work to do in the background, thus chrome<br>provide <strong>background</strong> for this use.</p>
<p>Firstly we create a new script <code>background.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'This is a messsage from background.'</span>);</div></pre></td></tr></table></figure>
<p>Then we add background attribute into <code>manifest.json</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"background"</span>: &#123;</div><div class="line">    <span class="attr">"scripts"</span>: [<span class="string">"js/background.js"</span>]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Reload our extension, then click <code>background page</code> in extension description,<br>we will see a developer tool of the <code>background.html</code> which is constructed<br>by chrome. In the console panel, there shows our string.</p>
<h2 id="Content-script"><a href="#Content-script" class="headerlink" title="Content script"></a>Content script</h2><p>If we want to insert some scripts into user tab to interact with it,<br>we make use of <strong>content script</strong>.</p>
<p>We write a script <code>content.js</code> as usual:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'This is a message from content script.'</span>);</div></pre></td></tr></table></figure>
<p>Then add content script attribute into <code>manifest.json</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"content_scripts"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"matches"</span>: [<span class="string">"*://www.google.com/"</span>],</div><div class="line">      <span class="attr">"js"</span>: [<span class="string">"js/background.js"</span>]</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>background.js</code> will be loaded when we visit google, our string will be seen<br>in developer tool.</p>
<h2 id="Setting"><a href="#Setting" class="headerlink" title="Setting"></a>Setting</h2><p>setting page is just like popup page.</p>
<h2 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h2><p>download is a module used in my project, which is provided by chrome.</p>
<p>We call downlaod like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrome.downlaods.download(&#123; <span class="attr">url</span>: img_url &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">downloadId</span>) </span>&#123;&#125;);</div></pre></td></tr></table></figure>
<p><code>downloadId</code> is the id of the download id of the download item,<br>it’s <code>undefined</code> if chrome failed to start downloading.</p>
<p>We can get deatils by downloadId like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chrome.downloads.search(&#123; <span class="attr">id</span>: downloadId &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">downloadItem</span>) </span>&#123;&#125;);</div></pre></td></tr></table></figure>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>So far we’ve created a frame of extension, the rest work is just like<br>web development. Open you mind to innovation and create best extension.</p>
<p>THE END</p>

</article>

      <footer>
  <div class="footer">
    &copy; 2015-2016 Yewmint, All rights reserved.
  </div>
</footer>

    </div>
  </body>
</html>
